

1. 网络配置：了解如何配置网络接口、IP 地址、子网掩码、网关等基本网络参数，以确保主机能够正确连接到网络。

2. 路由管理：学习路由表的概念，了解如何查看、添加、删除和修改路由条目，以实现不同网络间的数据包转发。

3. 防火墙配置：掌握 Linux 防火墙工具（如 iptables 或 firewalld）的使用，可以设置规则来控制进出主机的网络流量，保护系统安全。

4. 网络监控：学习使用网络监控工具（如 ifconfig、ip、tcpdump、Wireshark 等）来监视网络接口、网络流量、数据包传输等情况，以便及时排查和解决网络问题。

5. 网络服务配置：了解如何配置和管理常见的网络服务，比如 DNS 服务、DHCP 服务、Web 服务器、邮件服务器等，以提供各种网络功能和服务。

6. 软件定义网络（SDN）：了解 SDN 的概念和原理，以及如何在 Linux 系统上部署和管理 SDN 技术，实现灵活、高效的网络管理。

7. 负载均衡和故障转移：学习如何配置负载均衡器和实现故障转移机制，以确保网络服务的高可用性和可靠性。

### 网络配置

##### 查看网络接口信息
`ip addr` 命令是一个用于查看和管理网络接口信息的强大工具，替代了ifconfig。

1. **语法**：
```java
   ip addr [show/dev <interface>
		   |add <address>/<prefix_len> dev <interface>
		   |del <address>/<prefix_len> dev <interface>]
```

2. **常见用法**：

   - **查看所有网络接口信息**：执行 `ip addr show` 命令可列出系统中所有网络接口的详细信息，包括名称、MAC 地址、IP 地址、子网掩码、广播地址和状态等。

   - **查看特定接口信息**：可以使用 `ip addr show <interface>` 来显示特定网络接口的详细信息。例如：
	```shell
	ip addr show eth0
	```
```php
	2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP group default qlen 1000
    link/ether 52:54:00:03:15:76 brd ff:ff:ff:ff:ff:ff
    inet 10.0.4.10/22 brd 10.0.7.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::5054:ff:fe03:1576/64 scope link 
       valid_lft forever preferred_lft forever
```

   - **添加 IP 地址和子网掩码**：通过 `ip addr add` 命令可以为指定网络接口设置 IP 地址和子网掩码。例如，为 `eth0` 接口添加 IP 地址为 `192.168.0.2/24`：
     ```php
     sudo ip addr add 192.168.0.2/24 dev eth0
     ```

   - **删除 IP 地址**：使用 `ip addr del` 命令可以删除网络接口上的指定 IP 地址。举例，从 `eth0` 接口删除 IP 地址 `192.168.0.2`：
     ```php
     sudo ip addr del 192.168.0.2 dev eth0
     ```

3. **其他用法**：

   - `ip addr` 命令还可以显示、添加、删除和修改网络接口的其他属性，如广播地址、点对点地址、IPv6 地址 ,  MAC 地址、启用或禁用接口等。




##### 配置ip和子网掩码

1. ip addr配置

2. **永久配置**：

   - 在大多数 Linux 发行版中，网络接口的静态 IP 地址和子网掩码通常在 `/etc/network/interfaces` 文件中配置

   - 设置完成后，记得重启网络服务或者重启系统使更改生效。

### 网络架构
##### 常见网络模式架构
常见的网络模式包括以下几种：

1. 桥接模式（Bridge Mode）：在桥接模式下，虚拟机和宿主机连接到同一个物理网络，使得虚拟机就像是直接连接到了物理网络一样。

2. NAT模式（Network Address Translation Mode）：在NAT模式下，虚拟机通过宿主机进行网络通信，并且使用宿主机的IP地址来与外部网络通信。

3. 主机模式（Host-Only Mode）：在主机模式下，虚拟机可以与宿主机进行通信，但无法直接访问外部网络，只能与宿主机之间通信。

4. 内部网络模式（Internal Network Mode）：在内部网络模式下，虚拟机之间可以相互通信，但无法与外部网络通信，也无法与宿主机通信。

5. 隧道模式（Tunnel Mode）：隧道模式是通过在两个远程网络之间建立一个加密、安全的通道来实现网络通信，常用于连接不同地区或不同组织的网络。

这些网络模式在虚拟化技术和网络配置中经常被使用，每种模式都有其适用的场景和特点。

##### 桥接网络
1. 虚拟机和宿主机处于同一个局域网中：在桥接模式下，虚拟机的网络适配器会通过虚拟网桥连接到宿主机的物理网络适配器，使得虚拟机就像是直接连接到了宿主机所在的局域网中。
2. 虚拟机可以获取局域网内的IP地址：由于虚拟机和宿主机在同一个局域网中，虚拟机可以通过DHCP服务获取局域网内的IP地址，这样虚拟机就能够与局域网内的其他设备进行通信。
    
3. 虚拟机与外部网络通信：通过桥接模式，虚拟机可以与宿主机所在局域网外部的网络进行通信，实现虚拟机与外部网络的互联互通。

##### nat网络模式

在NAT（Network Address Translation）模式下，虚拟机和主机的网络关系如下：

1. 虚拟机使用宿主机的IP地址进行通信：在NAT模式下，虚拟机的网络流量会通过宿主机进行转发，虚拟机无法直接与宿主机所在的局域网内的其他设备通信。虚拟机会使用宿主机的IP地址来与外部网络通信。

2. 宿主机作为虚拟机和外部网络之间的中介：所有发往虚拟机的请求和响应都会经过宿主机，宿主机会根据NAT规则将这些数据包进行地址转换，使得虚拟机似乎直接与外部网络通信。

3. 虚拟机无法直接被外部网络访问：由于虚拟机使用宿主机的IP地址，外部网络无法直接访问虚拟机，需要通过宿主机来转发数据包。

总的来说，在NAT模式下，虚拟机通过宿主机进行网络通信，并且虚拟机无法直接被外部网络访问。宿主机扮演了虚拟机与外部网络之间的中介角色，对虚拟机的网络流量进行转发和地址转换。

### 网络连通分析步骤
确定主机连接到了正确的目的网络通常涉及以下几个步骤：

1. **检查 IP 地址配置**：首先，您需要确认主机的 IP 地址是否配置正确。您可以使用命令行工具如 `ifconfig` 或 `ipconfig` 来查看主机的 IP 地址、子网掩码和网关配置是否符合目标网络的要求。

2. **验证网关设置**：确保主机的网关设置正确。网关是连接本地网络与其他网络的关键设备，主机必须将数据包发送给网关以访问其他网络。通过检查网关设置是否指向正确的网关 IP 地址，可以确认主机连接到了正确的目的网络。

3. **进行连通性测试**：使用诸如 `ping` 命令或其他网络工具来测试主机与目标网络之间的连通性。如果能够成功 ping 通目标网络上的其他主机或服务器，那么主机很可能已经连接到了正确的网络。

4. **查看路由表**：查看主机的路由表，确为确保主机连接到了正确的目的网络，您可以执行以下几项验证步骤：

1. **检查 IP 地址配置**：首先，您可以确认主机的 IP 地址和子网掩码是否正确配置。您可以使用命令 `ifconfig` 或 `ip config`（取决于您的操作系统）来查看当前网络接口的配置信息。

2. **检查网关配置**：确认主机的默认网关是否正确配置。默认网关通常是主机用来发送数据到其他网络的路由器的 IP 地址。您可以使用 `route -n` 命令查看当前路由表信息，确保默认网关设置正确。

3. **Ping 测试**：尝试通过 Ping 命令测试主机是否能够与目标网络上的其他设备进行通信。您可以使用 `ping 目标IP地址` 进行测试。如果 Ping 成功，表示主机已经连接到了目标网络。

4. **Traceroute**：使用 traceroute 命令跟踪数据包从您的主机到目标网络的路径。这可以帮助您确定数据包是否按预期路由。使用 `traceroute 目标IP地址` 来执行 traceroute。

5. **网络拓扑图**：查看网络拓扑图，确认主机所在的网络拓扑结构和连接情况。这有助于您了解主机的实际连接位置和路径。

### 路由表分析

```shell
[root@VM-4-10-centos ~]# route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         10.0.4.1        0.0.0.0         UG    0      0        0 eth0
10.0.4.0        0.0.0.0         255.255.252.0   U     0      0        0 eth0
169.254.0.0     0.0.0.0         255.255.0.0     U     1002   0        0 eth0
172.17.0.0      0.0.0.0         255.255.0.0     U     0      0        0 docker0
```

这是路由表的输出结果，列出了系统中当前配置的路由信息。

- Destination：目标网络地址
- Gateway：<font color=#99CCFF style=" font-weight:bold;">路由数据包到达目标网络时要经过的下一网关</font>
- Genmask：子网掩码，用于确定网络中主机部分和网络部分的位数
- Flags：路由标志，如 UG 表示该路由是到一个默认网关（Default Gateway）的路由
- Metric：该路由的优先级，数值越小表示优先级越高
- Ref：路由的引用计数
- Use：显示该路由被使用的次数
- Iface：数据包在发送到目标网络时应该使用的网络接口

就由我来分析一下上面能得到什么信息:
上面分为两类网路:
* 走默认路由的,比如第一条
* 走本机本地网络的,比如后面三条,网关为0.0.0.0


1. 数据包目标地址为0.0.0.0的流量将通过网关10.0.4.1发送，这是默认网关。
2. 目标地址为10.0.4.0/22（即子网掩码255.255.252.0）的流量将直接发送到本地网络eth0。
3. 目标地址为169.254.0.0/16的流量将直接发送到本地网络eth0。
4. 目标地址为172.17.0.0/16的流量将直接发送到本地网络docker0。





```java
IPv4 路由表
===========================================================================
活动路由:
          网络目标        网络掩码                网关        接口          跃点数
          0.0.0.0          0.0.0.0            10.1.0.1      10.1.132.81    45
         10.1.0.0      255.255.0.0            在链路上       10.1.132.81    301
      10.1.132.81  255.255.255.255            在链路上       10.1.132.81    301
     10.1.255.255  255.255.255.255            在链路上       10.1.132.81    301
        127.0.0.0        255.0.0.0            在链路上         127.0.0.1    331
        127.0.0.1  255.255.255.255            在链路上         127.0.0.1    331
  127.255.255.255  255.255.255.255            在链路上         127.0.0.1    331
        224.0.0.0        240.0.0.0            在链路上         127.0.0.1    331
        224.0.0.0        240.0.0.0            在链路上       10.1.132.81    301
  255.255.255.255  255.255.255.255            在链路上         127.0.0.1    331
  255.255.255.255  255.255.255.255            在链路上       10.1.132.81    301
```
##### 什么是网关?

Gateway（网关）：是数据包在到达目标网络之前经过的中间设备。当数据包要前往一个不在本地网络内的目标地址时，需要通过网关来实现路由转发。

<font color=#FFCCCC style=" font-weight:bold;">我们在建立主机网络时通常需要配置三个参数,ip地址,子网掩码,网关, 其中这个网关就是这个主机的默认路由,这个默认路由的地址是通往路由器的</font>

++++++++++++++++++++++++++++++++++++++++++++错误+++++++++++++++++++
##### 什么是网络接口(网络适配器)?

Iface（网络接口）：表示数据包在传输过程中要经过的网络接口。每个网络接口都对应着系统中的一个物理或虚拟网络接口<font color=#99CCFF style=" font-weight:bold;">网卡</font>，用于连接系统与网络。<font color=#FFCCCC style=" font-weight:bold;">网卡就是以面向对象的思想将网络接口抽象为一个对象</font>
++++++++++++++++++++++++++++++++++++++++++++错误+++++++++++++++++++
##### 什么是vlan虚拟网络适配器
docker0就是虚拟网络接口, 可以理解为别名网络接口
一个主机上有一个网卡该网卡上有一个物理网络适配器,比如eth0
但还会有其他多个虚拟网络适配器, 比如一下情况:

1. **虚拟网络适配器**：Windows 10 系统中可能还会创建虚拟网络适配器，用于特定功能或网络配置。例如，VPN 连接、虚拟化软件（如 VMware、VirtualBox）创建的虚拟网络适配器还有docker都会显示为额外的网络适配器。
    
2. **无线网卡和有线网卡**：如果您的计算机同时连接了无线网络和有线网络，那么您会看到至少两个网络适配器：一个是无线网络适配器，另一个是有线网络适配器。
    
3. **隧道适配器**：某些软件可能会创建虚拟的隧道适配器，用于特定类型的网络通信，这样也会显示为一个额外的网络适配器。

当本机内需要一个独立的网络适配器时,比如docker容器直接进行通信
就需要创建一个虚拟的网络接口比如docker0,此时


##### 什么是目标地址
Destination（目标地址）：指定了数据包要到达的目标网络地址。当数据包的目标地址匹配路由表中的某个目标地址时，系统就会按照对应的路由规则进行处理。


综合起来，路由表中的每一条路由规则包含了目标地址、网关和网络接口这三个重要元素。当系统接收到一个数据包时，会根据目标地址查找匹配的路由规则，并确定数据包应该经过哪个网关以及使用哪个网络接口发送出去。这样确保了数据包能够正确到达目标网络。

##### 网络拓扑图

```shell
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         10.0.4.1        0.0.0.0         UG    0      0        0 eth0
10.0.4.0        0.0.0.0         255.255.252.0   U     0      0        0 eth0
169.254.0.0     0.0.0.0         255.255.0.0     U     1002   0        0 eth0
172.17.0.0      0.0.0.0         255.255.0.0     U     0      0        0 docker0
```

根据这个路由表，下面是基于本机的网络拓扑图：

```php
                                    +-----------+
                                    |           |
                                    | 主机配置的  |
                                    | 网关路由器  |
                                    +-----+-----+
                                    
                                          |
                                          |
         +---------------------------------                   
         |                                               
   10.0.4.1 本机配置的
   默认网关,在本网络中的ip地址                                        
         |            +-----+------+              
         |            |   本机网卡  |                          
         |            |视为一个路由器|      
         |            |-----|------|--------- 
         |            | eth0|docker0|veth8网络适配器-----------docker的redis容器
		 +------------|网络适|交换机  |------        
					  | 配器 |172.17 |veth9网络适配器-----------docker的nginx容器
					  |     |.0.0/16|-------		           网关是 0.0.0.0代表当目的地址是
                      +-----+------+                           172.17.0.0/16中的时,网关就在本网络里
                        |                                        就在本路由器直连(本网络)
                        |                                           里,就不需要找下一跳路由了
                        |                            
                   +----+----+                    
                   |         |                   
                   |         |                    
      本地子网 10.0.4.0/22   本地子网 169.254.0.0/16    这两个子网的网络架构是?  
```

在上面的网络拓扑图中，你可以看到：
- Internet 连接到本地网络通过网关地址 10.0.4.1。
- 本地网络中有两个接口：eth0 和 docker0，分别连接到本地网络的不同子网。
- eth0 接口处理 10.0.4.0/22 子网的通信。
- <font color=#99CCFF style=" font-weight:bold;">docker0 接口连接一个交换机(网桥),处理 Docker 容器网络 172.17.0.0/16 的通信</font>。

##### ifconfig查看网络适配器和交换机

```c
[root@VM-4-10-centos ~]# ifconfig 
docker0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255
        inet6 fe80::42:3bff:fe11:6720  prefixlen 64  scopeid 0x20<link>
        ether 02:42:3b:11:67:20  txqueuelen 0  (Ethernet)
        RX packets 133702  bytes 133386772 (127.2 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 146889  bytes 20056160 (19.1 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.0.4.10  netmask 255.255.252.0  broadcast 10.0.7.255
        inet6 fe80::5054:ff:fe03:1576  prefixlen 64  scopeid 0x20<link>
        ether 52:54:00:03:15:76  txqueuelen 1000  (Ethernet)
        RX packets 211136408  bytes 28603346104 (26.6 GiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 213430320  bytes 27808515844 (25.8 GiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 15  bytes 1920 (1.8 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 15  bytes 1920 (1.8 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

veth8fa0241: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet6 fe80::c0a9:6dff:fe76:1c82  prefixlen 64  scopeid 0x20<link>
        ether c2:a9:6d:76:1c:82  txqueuelen 0  (Ethernet)
        RX packets 93996  bytes 109511147 (104.4 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 104132  bytes 16299650 (15.5 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

veth9e027cd: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet6 fe80::8852:dcff:fe7b:628  prefixlen 64  scopeid 0x20<link>
        ether 8a:52:dc:7b:06:28  txqueuelen 0  (Ethernet)
        RX packets 34111  bytes 24558983 (23.4 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 41544  bytes 3544672 (3.3 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

```


桥接下的ip分配方式是?
docker的容器之间的ip分配方式













### 栈
在学习 Linux 网络配置时，我们可以深入了解以下几个核心概念和技能：

1. 网络接口配置：了解如何查看系统中的网络接口信息，如网卡名称、MAC 地址等，以及如何配置网络接口的参数，如 IP 地址、子网掩码、MTU 等。常用命令包括 `ifconfig` 和 `ip addr`。

2. IP 地址配置：掌握如何为系统配置静态 IP 地址或使用 DHCP 动态获取 IP 地址，以确保主机能够正确与网络通信。可以通过编辑配置文件（如 `/etc/network/interfaces`）或使用命令行工具进行配置。

3. 子网掩码配置：了解子网掩码的作用和原理，学习如何设置正确的子网掩码以划分网络和确定主机所属的子网。

4. 网关配置：理解网关的作用，学习如何配置默认网关以实现主机与其他网络的通信。通常需要编辑网络配置文件或使用 `route` 命令添加网关。

5. DNS 配置：了解 DNS 的作用和原理，学习如何配置主机的 DNS 服务器地址以实现域名解析。可以编辑 `/etc/resolv.conf` 文件来配置 DNS 服务器。

6. 网卡绑定（Bonding）和虚拟网卡（VLAN）：学习如何配置网卡绑定或虚拟网卡，以实现负载均衡、故障转移或虚拟网络划分等特定网络需求。

7. 网卡状态管理：了解如何启用或禁用网络接口，以及如何查看和修改接口的状态和属性。常用命令包括 `ifup`、`ifdown` 和 `ethtool`。

通过深入学习以上内容，可以帮助管理员更好地理解和配置 Linux 系统中的网络接口，确保系统正确连接到网络并顺利进行网络通信。这些知识对于构建稳定、高效的网络环境至关重要，并且有助于快速排除网络配置问题和故障。















+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
